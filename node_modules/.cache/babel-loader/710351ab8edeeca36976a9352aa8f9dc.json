{"remainingRequest":"/home/desarrollo/Escritorio/unabasev4/node_modules/thread-loader/dist/cjs.js!/home/desarrollo/Escritorio/unabasev4/node_modules/babel-loader/lib/index.js!/home/desarrollo/Escritorio/unabasev4/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/desarrollo/Escritorio/unabasev4/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/desarrollo/Escritorio/unabasev4/src/pages/outcomes/outcomes.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/desarrollo/Escritorio/unabasev4/src/pages/outcomes/outcomes.vue","mtime":1552492247328},{"path":"/home/desarrollo/Escritorio/unabasev4/.babelrc","mtime":1547153504905},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Promise from \"/home/desarrollo/Escritorio/unabasev4/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.function.name\";\nimport _objectSpread from \"/home/desarrollo/Escritorio/unabasev4/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// VUEX\nimport { mapActions, mapGetters, mapMutations, mapState } from 'vuex';\nimport { Modal } from '@/components';\nimport store from '../../store/store.js';\nimport isMobile from '../../assets/js/isMobile.js';\nimport errorModal from '@/pages/Dashboard/Components/errorModal.vue';\nimport spinner from '../Dashboard/Components/spinner';\nimport _ from 'lodash';\nimport { ChartCard, ProductCard, AnimatedNumber, GlobalSalesCard } from '@/components';\nexport default {\n  components: {\n    Modal: Modal,\n    errorModal: errorModal,\n    ChartCard: ChartCard,\n    spinner: spinner\n  },\n  data: function data() {\n    return {\n      checkbox1: null,\n      outcomes: [],\n      value: null,\n      loading: false,\n      isMobile: null\n    };\n  },\n  methods: _objectSpread({}, mapActions({\n    getAllOutcomes: 'incomes/getAllIncomes'\n  }), mapMutations({\n    hideShowBottom: 'HIDE_SHOW_BOTTOM',\n    cleanItem: 'items/CLEAN',\n    sliceIcome: 'incomes/SLICE_INCOME'\n  }), {\n    handleBottomNav: function handleBottomNav(state) {\n      this.cleanItem();\n    },\n    get_clientName: function get_clientName(responsable) {\n      if (responsable.type == 'User' || responsable.type == 'Contact' || responsable.type == 'Business') {\n        return responsable.data.name;\n      } else {\n        return responsable.name;\n      }\n    },\n    getTotal: function getTotal(lines) {\n      var total = _.sumBy(lines, function (line) {\n        return line.price * line.quantity;\n      });\n\n      return {\n        net: total,\n        tax: total * 0.19,\n        total: total * 0.19 + total\n      };\n    },\n    deleteIncome: function deleteIncome(movement) {\n      var _this = this;\n\n      this.showIncomes = false;\n\n      if (movement) {\n        var obj = {\n          _id: movement._id,\n          isActive: false\n        };\n        this.sliceIcome(movement);\n        this.$store.dispatch('incomes/putIncome', obj).then(function (res) {\n          if (res) {\n            _this.showIncomes = true;\n\n            _this.$toasted.show('Documento eliminado!');\n\n            _this.$router.push('/outcomes');\n          }\n        });\n      }\n    }\n  }),\n  computed: _objectSpread({}, mapGetters({\n    getUser: 'users/user',\n    getErrors: 'incomes/getErrors',\n    getOutcomes: 'incomes/getIncomes',\n    getBusinessScope: 'getBusinessScope',\n    getCurrencyConfig: 'getCurrencyConfig'\n  }), mapState({\n    outcomesGetParams: 'incomesGetParams'\n  })),\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.isMobile = isMobile;\n    return new _Promise(function (resolve, reject) {\n      if (_this2.getBusinessScope._id) {\n        resolve('/' + _this2.getBusinessScope._id);\n      } else {\n        resolve('');\n      }\n    }).then(function (data) {\n      _this2.loading = true;\n\n      _this2.getAllOutcomes({\n        params: \"\".concat(_this2.outcomesGetParams),\n        type: 'out',\n        isBusiness: data\n      }).then(function (res) {\n        _this2.outcomes = res;\n        _this2.loading = false;\n      }).catch(function (err) {\n        console.log('this.getErrors --> ', _this2.getErrors);\n      });\n    });\n  },\n  watch: {\n    outcomesGetParams: function outcomesGetParams() {\n      this.getAllOutcomes(\"\".concat(this.outcomesGetParams));\n    },\n    getBusinessScope: function getBusinessScope(val) {\n      this.getAllOutcomes({\n        params: \"\".concat(this.outcomesGetParams),\n        type: 'out',\n        isBusiness: val._id ? '/' + this.getBusinessScope._id : ''\n      });\n    }\n  },\n  beforeRouteEnter: function beforeRouteEnter(to, from, next) {\n    store.commit('HANDLE_ISOUTCOME', true);\n    next();\n  },\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    store.commit('HANDLE_ISOUTCOME', false);\n    next();\n  }\n};",{"version":3,"sources":["outcomes.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div>\n      <div v-if=\"getErrors\">\n        <error-modal :errorObject=\"getErrors\"></error-modal>\n      </div>\n\n      <!-- LISTA -->\n      <div class=\"md-layout\">\n        <div class=\"md-layout-item md-size-10F0 md-xsmall-size-100\">\n          <div v-if=\"loading\">\n            <spinner></spinner>\n          </div>\n\n          <center v-if=\"!outcomes.docs\"></center>\n\n          <ul v-else class=\"collection\" style=\"padding: 0; border-style: none;\">\n            <div class=\"container-fluid\" v-if=\"getOutcomes.docs.length <= 0\">\n              <center class=\"spinner\">\n                <md-empty-state\n                  md-icon=\"add_shopping_cart\"\n                  md-label=\"No tienes compras\"\n                  md-description=\"Haz tu primera compra mediante unabase\"\n                ></md-empty-state>\n              </center>\n              <center>\n                <router-link\n                  :to=\"{path:'/outcome'}\"\n                  class=\"md-success md-raised md-simple\"\n                  tag=\"md-button\"\n                >Nueva compra</router-link>\n              </center>\n            </div>\n            <div v-else>\n              <transition-group name=\"slide-fade\">\n                <li\n                  class=\"collection-item avatar\"\n                  v-for=\"(outcome, index) in getOutcomes.docs\"\n                  :key=\"outcome._id\"\n                  @click=\"handleBottomNav(false)\"\n                  v-hammer:swipe.right=\"(event)=> deleteIncome(outcome, index)\"\n                >\n                  <div>\n                    <router-link :to=\"{path:'/outcome/'+outcome._id}\" style=\"color: black;\">\n                      <div v-if=\"outcome.responsable.type == 'User'\" style=\"margin-bottom: -83px;\">\n                        <div class=\"row\">\n                          <div class=\"col s12\">\n                            <img\n                              v-if=\"outcome.responsable.data.imgUrl\"\n                              :src=\"outcome.responsable.data.imgUrl\"\n                              alt\n                              :class=\"[(outcome.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                              style=\"vertical-align: center;\"\n                            >\n                            <img\n                              v-else\n                              src=\"../../../public/img/default-avatar.png\"\n                              alt\n                              :class=\"[(outcome.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                              style=\"vertical-align: center;\"\n                            >\n                          </div>\n                        </div>\n                        <br>\n                        <div class=\"row\">\n                          <div class=\"col s12\" style=\"margin-left: -60px;\">\n                            <small\n                              :class=\"[(outcome.state == 'draft')?'text-warning': 'text-success']\"\n                            >{{(outcome.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div v-else style=\"margin-bottom: -83px;\">\n                        <div style=\"display:contents\" v-if=\"outcome.responsable.type == 'Business'\">\n                          <div class=\"row\">\n                            <div class=\"col s12\">\n                              <img\n                                src=\"../../assets/img/company_icon.png\"\n                                alt\n                                :class=\"[(outcome.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                                style=\"vertical-align: center;\"\n                              >\n                            </div>\n                          </div>\n                          <br>\n                          <div class=\"row\">\n                            <div class=\"col s12\" style=\"margin-left: -60px;\">\n                              <small\n                                :class=\"[(outcome.state == 'draft')?'text-warning': 'text-success']\"\n                              >{{(outcome.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                            </div>\n                          </div>\n                        </div>\n                        <div style=\"display:contents\" v-else>\n                          <div class=\"row\">\n                            <div class=\"col s12\">\n                              <img\n                                src=\"../../../public/img/default-avatar.png\"\n                                alt\n                                :class=\"[(outcome.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                                style=\"vertical-align: center;\"\n                              >\n                            </div>\n                          </div>\n                          <br>\n                          <div class=\"row\">\n                            <div class=\"col s12\" style=\"margin-left: -60px;\">\n                              <small\n                                :class=\"[(outcome.state == 'draft')?'text-warning': 'text-success']\"\n                              >{{(outcome.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <span class>\n                        <b>{{outcome.name}}</b>\n                      </span>\n\n                      <p>\n                        {{get_clientName(outcome.responsable)}}\n                        <br>\n                        <small>{{outcome.createdAt | shortDate}}</small>\n                      </p>\n\n                      <a style=\"text-decoration: none;\" class=\"secondary-content valign-wrapper\">\n                        <h5\n                          v-if=\"isMobile\"\n                          class=\"text-center text-success\"\n                        >{{(getTotal(outcome.lines).total) | currency}}</h5>\n                        <h3\n                          v-else\n                          class=\"text-center text-success\"\n                        >{{(getTotal(outcome.lines).total) | currency}}</h3>\n                      </a>\n                    </router-link>\n                  </div>\n                </li>\n              </transition-group>\n            </div>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// VUEX\nimport { mapActions, mapGetters, mapMutations, mapState } from 'vuex';\nimport { Modal } from '@/components';\nimport store from '../../store/store.js';\nimport isMobile from '../../assets/js/isMobile.js';\n\nimport errorModal from '@/pages/Dashboard/Components/errorModal.vue';\nimport spinner from '../Dashboard/Components/spinner';\nimport _ from 'lodash';\n\nimport {\n  ChartCard,\n  ProductCard,\n  AnimatedNumber,\n  GlobalSalesCard\n} from '@/components';\n\nexport default {\n  components: {\n    Modal,\n    errorModal,\n    ChartCard,\n    spinner\n  },\n\n  data() {\n    return {\n      checkbox1: null,\n      outcomes: [],\n      value: null,\n      loading: false,\n      isMobile: null\n    };\n  },\n\n  methods: {\n    ...mapActions({\n      getAllOutcomes: 'incomes/getAllIncomes'\n    }),\n    ...mapMutations({\n      hideShowBottom: 'HIDE_SHOW_BOTTOM',\n      cleanItem: 'items/CLEAN',\n      sliceIcome: 'incomes/SLICE_INCOME'\n    }),\n\n    handleBottomNav(state) {\n      this.cleanItem();\n    },\n    get_clientName(responsable) {\n      if (\n        responsable.type == 'User' ||\n        responsable.type == 'Contact' ||\n        responsable.type == 'Business'\n      ) {\n        return responsable.data.name;\n      } else {\n        return responsable.name;\n      }\n    },\n    getTotal(lines) {\n      let total = _.sumBy(lines, function(line) {\n        return line.price * line.quantity;\n      });\n\n      return {\n        net: total,\n        tax: total * 0.19,\n        total: total * 0.19 + total\n      };\n    },\n    deleteIncome(movement) {\n      this.showIncomes = false;\n      if (movement) {\n        let obj = {\n          _id: movement._id,\n          isActive: false\n        };\n        this.sliceIcome(movement);\n        this.$store.dispatch('incomes/putIncome', obj).then(res => {\n          if (res) {\n            this.showIncomes = true;\n            this.$toasted.show('Documento eliminado!');\n            this.$router.push('/outcomes');\n          }\n        });\n      }\n    }\n  },\n  computed: {\n    ...mapGetters({\n      getUser: 'users/user',\n      getErrors: 'incomes/getErrors',\n      getOutcomes: 'incomes/getIncomes',\n      getBusinessScope: 'getBusinessScope',\n      getCurrencyConfig: 'getCurrencyConfig'\n    }),\n    ...mapState({\n      outcomesGetParams: 'incomesGetParams'\n    })\n  },\n\n  mounted() {\n    this.isMobile = isMobile;\n    return new Promise((resolve, reject) => {\n      if (this.getBusinessScope._id) {\n        resolve('/' + this.getBusinessScope._id);\n      } else {\n        resolve('');\n      }\n    }).then(data => {\n      this.loading = true;\n      this.getAllOutcomes({\n        params: `${this.outcomesGetParams}`,\n        type: 'out',\n        isBusiness: data\n      })\n        .then(res => {\n          this.outcomes = res;\n          this.loading = false;\n        })\n        .catch(err => {\n          console.log('this.getErrors --> ', this.getErrors);\n        });\n    });\n  },\n\n  watch: {\n    outcomesGetParams: function() {\n      this.getAllOutcomes(`${this.outcomesGetParams}`);\n    },\n    getBusinessScope: function(val) {\n      this.getAllOutcomes({\n        params: `${this.outcomesGetParams}`,\n        type: 'out',\n        isBusiness: val._id ? '/' + this.getBusinessScope._id : ''\n      });\n    }\n  },\n  beforeRouteEnter: (to, from, next) => {\n    store.commit('HANDLE_ISOUTCOME', true);\n    next();\n  },\n\n  beforeRouteLeave(to, from, next) {\n    store.commit('HANDLE_ISOUTCOME', false);\n    next();\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n#tabla_ventas {\n  display: none;\n}\n\n@media (min-width: 992px) {\n  .md-hide-big {\n    display: none;\n  }\n}\n\n.md-layout-item {\n  padding-right: 0px;\n  padding-left: 0px;\n}\n\n.md-tabs {\n  margin-bottom: 24px;\n}\n.spinner {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  // position: fixed;\n  align-items: center;\n  justify-content: center;\n}\n\n.pendingClass {\n  border-color: #ffd600;\n  border-style: ridge;\n}\n.successClass {\n  border-color: #00c853;\n  border-style: ridge;\n}\n</style>\n"],"sourceRoot":"src/pages/outcomes"}]}