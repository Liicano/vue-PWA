{"remainingRequest":"/home/desarrollo/Escritorio/unabasev4/node_modules/babel-loader/lib/index.js!/home/desarrollo/Escritorio/unabasev4/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/desarrollo/Escritorio/unabasev4/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/desarrollo/Escritorio/unabasev4/src/pages/incomes/incomes.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/desarrollo/Escritorio/unabasev4/src/pages/incomes/incomes.vue","mtime":1552581285832},{"path":"/home/desarrollo/Escritorio/unabasev4/.babelrc","mtime":1547153504905},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Promise from \"/home/desarrollo/Escritorio/unabasev4/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.function.name\";\nimport _objectSpread from \"/home/desarrollo/Escritorio/unabasev4/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// VUEX\nimport { mapActions, mapGetters, mapMutations, mapState } from 'vuex';\nimport { Modal } from '@/components';\nimport errorModal from '@/pages/Dashboard/Components/errorModal.vue';\nimport isMobile from '../../assets/js/isMobile.js';\nimport spinner from '../Dashboard/Components/spinner';\nimport _ from 'lodash';\nimport { ChartCard, ProductCard, AnimatedNumber, GlobalSalesCard } from '@/components';\nexport default {\n  components: {\n    Modal: Modal,\n    errorModal: errorModal,\n    ChartCard: ChartCard,\n    spinner: spinner\n  },\n  data: function data() {\n    return {\n      checkbox1: null,\n      incomes: [],\n      value: null,\n      loading: false,\n      getData: null,\n      isMobile: null,\n      showIncomes: true,\n      showw: true,\n      currencyScope: {}\n    };\n  },\n  methods: _objectSpread({}, mapActions({\n    getAllIncomes: 'incomes/getAllIncomes'\n  }), mapMutations({\n    hideShowBottom: 'HIDE_SHOW_BOTTOM',\n    cleanItem: 'items/CLEAN',\n    sliceIcome: 'incomes/SLICE_INCOME'\n  }), {\n    handleBottomNav: function handleBottomNav(state) {// this.cleanItem();\n    },\n    get_clientName: function get_clientName(client) {\n      if (client.type == 'User' || client.type == 'Contact' || client.type == 'Business') {\n        return client.data.name;\n      } else {\n        return client.name;\n      }\n    },\n    getTotal: function getTotal(lines) {\n      var total = _.sumBy(lines, function (line) {\n        return line.price * line.quantity;\n      });\n\n      return {\n        net: total,\n        tax: total * 0.19,\n        total: total * 0.19 + total\n      };\n    },\n    deleteIncome: function deleteIncome(movement) {\n      var _this = this;\n\n      this.showIncomes = false;\n\n      if (movement) {\n        var obj = {\n          _id: movement._id,\n          isActive: false\n        };\n        this.sliceIcome(movement);\n        this.$store.dispatch('incomes/putIncome', obj).then(function (res) {\n          if (res) {\n            _this.showIncomes = true;\n\n            _this.$toasted.show('Documento eliminado!');\n\n            _this.$router.push('/incomes');\n          }\n        });\n      }\n    }\n  }),\n  computed: _objectSpread({}, mapGetters({\n    getUser: 'users/user',\n    getErrors: 'incomes/getErrors',\n    getIncomes: 'incomes/getIncomes',\n    getBusinessScope: 'getBusinessScope',\n    getCurrencyConfig: 'getCurrencyConfig'\n  }), mapState({\n    incomesGetParams: 'incomesGetParams'\n  })),\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.isMobile = isMobile;\n    return new _Promise(function (resolve, reject) {\n      if (_this2.getBusinessScope._id) {\n        resolve('/' + _this2.getBusinessScope._id);\n      } else {\n        resolve('');\n      }\n    }).then(function (data) {\n      _this2.getData = data;\n      _this2.loading = true;\n\n      _this2.getAllIncomes({\n        params: \"\".concat(_this2.incomesGetParams),\n        type: 'in',\n        isBusiness: data\n      }).then(function (res) {\n        _this2.incomes = res;\n        _this2.loading = false;\n      }).catch(function (err) {\n        console.log('this.getErrors --> ', _this2.getErrors);\n      });\n    });\n  },\n  watch: {\n    incomesGetParams: function incomesGetParams() {\n      this.getAllIncomes(\"\".concat(this.incomesGetParams));\n    },\n    getBusinessScope: function getBusinessScope(val) {\n      this.getAllIncomes({\n        params: \"\".concat(this.incomesGetParams),\n        type: 'in',\n        isBusiness: val._id ? '/' + this.getBusinessScope._id : ''\n      });\n    }\n  }\n};",{"version":3,"sources":["incomes.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div>\n      <div v-if=\"getErrors\">\n        <error-modal :errorObject=\"getErrors\"></error-modal>\n      </div>\n\n      <!-- LISTA -->\n      <div class=\"md-layout\">\n        <div class=\"md-layout-item md-size-10F0 md-xsmall-size-100\" style=\"padding: 0 !important\">\n          <div v-if=\"loading\">\n            <spinner></spinner>\n          </div>\n          <center v-if=\"!incomes.docs\"></center>\n          <ul v-else class=\"collection\" style=\"padding: 0; border-style: none;\">\n            <div class=\"container-fluid\" v-if=\"getIncomes.docs.length <= 0\">\n              <center class=\"spinner\">\n                <md-empty-state\n                  md-icon=\"add_shopping_cart\"\n                  md-label=\"Crea tu primera venta\"\n                  md-description=\"Crea tu primera venta dando click al boton de abajo.\"\n                >\n                  <router-link\n                    :to=\"{path:'/income'}\"\n                    class=\"md-success md-raised md-simple\"\n                    tag=\"md-button\"\n                  >Nueva venta</router-link>\n                </md-empty-state>\n              </center>\n            </div>\n            <div v-else>\n              <transition-group name=\"slide-fade\">\n                <li\n                  class=\"collection-item avatar\"\n                  v-for=\"(income, index) in getIncomes.docs\"\n                  :key=\"income._id\"\n                  @click=\"handleBottomNav(false)\"\n                  v-hammer:swipe.right=\"(event)=> deleteIncome(income, index)\"\n                  v-init:currencyScope=\"{options: {thousandsSeparator:income.currency.thousand,decimalSeparator:income.currency.decimal,spaceBetweenAmountAndSymbol: true} }\"\n                >\n                  <div>\n                    <router-link :to=\"{path:'/income/'+income._id}\" style=\"color: black;\">\n                      <div\n                        v-if=\"income.client.type == 'User'\"\n                        style=\"margin-bottom: -83px; !important\"\n                      >\n                        <div class=\"row\">\n                          <div class=\"col s12\">\n                            <img\n                              v-if=\"income.client.data.imgUrl\"\n                              :src=\"income.client.data.imgUrl\"\n                              alt\n                              :class=\"[(income.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                              style=\"vertical-align: center;\"\n                            >\n                            <img\n                              v-else\n                              src=\"../../../public/img/default-avatar.png\"\n                              alt\n                              :class=\"[(income.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                              style=\"vertical-align: center;\"\n                            >\n                          </div>\n                        </div>\n                        <br>\n                        <div class=\"row\">\n                          <div class=\"col s12\" style=\"margin-left: -60px;\">\n                            <small\n                              :class=\"[(income.state == 'draft')?'text-warning': 'text-success']\"\n                            >{{(income.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div v-else style=\"margin-bottom: -83px; !important\">\n                        <div style=\"display:contents\" v-if=\"income.client.type == 'Business'\">\n                          <div class=\"row\">\n                            <div class=\"col s12\">\n                              <img\n                                src=\"../../assets/img/company_icon.png\"\n                                alt\n                                :class=\"[(income.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                                style=\"vertical-align: center;\"\n                              >\n                            </div>\n                          </div>\n                          <br>\n                          <div class=\"row\">\n                            <div class=\"col s12\" style=\"margin-left: -60px;\">\n                              <small\n                                :class=\"[(income.state == 'draft')?'text-warning': 'text-success']\"\n                              >{{(income.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                            </div>\n                          </div>\n                        </div>\n\n                        <div style=\"display:contents\" v-else>\n                          <div class=\"row\">\n                            <div class=\"col s12\">\n                              <img\n                                src=\"../../../public/img/default-avatar.png\"\n                                alt\n                                :class=\"[(income.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                                style=\"vertical-align: center;\"\n                              >\n                            </div>\n                          </div>\n                          <br>\n                          <div class=\"row\">\n                            <div class=\"col s12\" style=\"margin-left: -60px;\">\n                              <small\n                                :class=\"[(income.state == 'draft')?'text-warning': 'text-success']\"\n                              >{{(income.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <span class>\n                        <b>{{income.name}}</b>\n                        <br>\n                        <p>\n                          {{get_clientName(income.client)}}\n                          <br>\n                          <small>{{income.createdAt | shortDate}}</small>\n                        </p>\n                      </span>\n                      \n                      <a style=\"text-decoration: none;\" class=\"secondary-content valign-wrapper\">\n                        <h5\n                          v-if=\"isMobile\"\n                          class=\"text-center text-success\"\n                        >{{(getTotal(income.lines).total) | currency(income.currency.prefix, income.currency.precision, currencyScope.options)}}</h5>\n                        <h3\n                          v-else\n                          class=\"text-center text-success\"\n                        >{{(getTotal(income.lines).total) | currency(income.currency.prefix, income.currency.precision, currencyScope.options)}}</h3>\n                      </a>\n                    </router-link>\n                  </div>\n                </li>\n              </transition-group>\n            </div>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// VUEX\nimport { mapActions, mapGetters, mapMutations, mapState } from 'vuex';\nimport { Modal } from '@/components';\nimport errorModal from '@/pages/Dashboard/Components/errorModal.vue';\nimport isMobile from '../../assets/js/isMobile.js';\nimport spinner from '../Dashboard/Components/spinner';\n\nimport _ from 'lodash';\n\nimport {\n  ChartCard,\n  ProductCard,\n  AnimatedNumber,\n  GlobalSalesCard\n} from '@/components';\n\nexport default {\n  components: {\n    Modal,\n    errorModal,\n    ChartCard,\n    spinner\n  },\n\n  data() {\n    return {\n      checkbox1: null,\n      incomes: [],\n      value: null,\n      loading: false,\n      getData: null,\n      isMobile: null,\n      showIncomes: true,\n      showw: true,\n      currencyScope: {}\n    };\n  },\n\n  methods: {\n    ...mapActions({\n      getAllIncomes: 'incomes/getAllIncomes'\n    }),\n    ...mapMutations({\n      hideShowBottom: 'HIDE_SHOW_BOTTOM',\n      cleanItem: 'items/CLEAN',\n      sliceIcome: 'incomes/SLICE_INCOME'\n    }),\n\n    handleBottomNav(state) {\n      // this.cleanItem();\n    },\n\n    get_clientName(client) {\n      if (\n        client.type == 'User' ||\n        client.type == 'Contact' ||\n        client.type == 'Business'\n      ) {\n        return client.data.name;\n      } else {\n        return client.name;\n      }\n    },\n    getTotal(lines) {\n      let total = _.sumBy(lines, function(line) {\n        return line.price * line.quantity;\n      });\n\n      return {\n        net: total,\n        tax: total * 0.19,\n        total: total * 0.19 + total\n      };\n    },\n\n    deleteIncome(movement) {\n      this.showIncomes = false;\n      if (movement) {\n        let obj = {\n          _id: movement._id,\n          isActive: false\n        };\n        this.sliceIcome(movement);\n        this.$store.dispatch('incomes/putIncome', obj).then(res => {\n          if (res) {\n            this.showIncomes = true;\n            this.$toasted.show('Documento eliminado!');\n            this.$router.push('/incomes');\n          }\n        });\n      }\n    }\n  },\n  computed: {\n    ...mapGetters({\n      getUser: 'users/user',\n      getErrors: 'incomes/getErrors',\n      getIncomes: 'incomes/getIncomes',\n      getBusinessScope: 'getBusinessScope',\n      getCurrencyConfig: 'getCurrencyConfig'\n    }),\n    ...mapState({\n      incomesGetParams: 'incomesGetParams'\n    })\n  },\n\n  mounted() {\n    this.isMobile = isMobile;\n    return new Promise((resolve, reject) => {\n      if (this.getBusinessScope._id) {\n        resolve('/' + this.getBusinessScope._id);\n      } else {\n        resolve('');\n      }\n    }).then(data => {\n      this.getData = data;\n      this.loading = true;\n      this.getAllIncomes({\n        params: `${this.incomesGetParams}`,\n        type: 'in',\n        isBusiness: data\n      })\n        .then(res => {\n          this.incomes = res;\n          this.loading = false;\n        })\n        .catch(err => {\n          console.log('this.getErrors --> ', this.getErrors);\n        });\n    });\n  },\n\n  watch: {\n    incomesGetParams: function() {\n      this.getAllIncomes(`${this.incomesGetParams}`);\n    },\n    getBusinessScope: function(val) {\n      this.getAllIncomes({\n        params: `${this.incomesGetParams}`,\n        type: 'in',\n        isBusiness: val._id ? '/' + this.getBusinessScope._id : ''\n      });\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n#tabla_ventas {\n  display: none;\n}\n\n@media (min-width: 992px) {\n  .md-hide-big {\n    display: none;\n  }\n}\n\n.md-layout-item {\n  padding-right: 0px;\n  padding-left: 0px;\n}\n\n.md-tabs {\n  margin-bottom: 24px;\n}\n.spinner {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  // position: fixed;\n  align-items: center;\n  justify-content: center;\n}\n.pendingClass {\n  border-color: #ffd600;\n  border-style: ridge;\n}\n.successClass {\n  border-color: #00c853;\n  border-style: ridge;\n}\n\n.md-list-item-content {\n  padding: 0 !important;\n}\n.md-list-item .md-list-item-container .md-ripple {\n  padding: 0 !important;\n}\n</style>\n"],"sourceRoot":"src/pages/incomes"}]}