{"remainingRequest":"/home/desarrollo/Escritorio/unabasev4/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/desarrollo/Escritorio/unabasev4/src/pages/outcomes/outcomes.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/desarrollo/Escritorio/unabasev4/src/pages/outcomes/outcomes.vue","mtime":1552492247328},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/desarrollo/Escritorio/unabasev4/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// VUEX\nimport { mapActions, mapGetters, mapMutations, mapState } from 'vuex';\nimport { Modal } from '@/components';\nimport store from '../../store/store.js';\nimport isMobile from '../../assets/js/isMobile.js';\n\nimport errorModal from '@/pages/Dashboard/Components/errorModal.vue';\nimport spinner from '../Dashboard/Components/spinner';\nimport _ from 'lodash';\n\nimport {\n  ChartCard,\n  ProductCard,\n  AnimatedNumber,\n  GlobalSalesCard\n} from '@/components';\n\nexport default {\n  components: {\n    Modal,\n    errorModal,\n    ChartCard,\n    spinner\n  },\n\n  data() {\n    return {\n      checkbox1: null,\n      outcomes: [],\n      value: null,\n      loading: false,\n      isMobile: null\n    };\n  },\n\n  methods: {\n    ...mapActions({\n      getAllOutcomes: 'incomes/getAllIncomes'\n    }),\n    ...mapMutations({\n      hideShowBottom: 'HIDE_SHOW_BOTTOM',\n      cleanItem: 'items/CLEAN',\n      sliceIcome: 'incomes/SLICE_INCOME'\n    }),\n\n    handleBottomNav(state) {\n      this.cleanItem();\n    },\n    get_clientName(responsable) {\n      if (\n        responsable.type == 'User' ||\n        responsable.type == 'Contact' ||\n        responsable.type == 'Business'\n      ) {\n        return responsable.data.name;\n      } else {\n        return responsable.name;\n      }\n    },\n    getTotal(lines) {\n      let total = _.sumBy(lines, function(line) {\n        return line.price * line.quantity;\n      });\n\n      return {\n        net: total,\n        tax: total * 0.19,\n        total: total * 0.19 + total\n      };\n    },\n    deleteIncome(movement) {\n      this.showIncomes = false;\n      if (movement) {\n        let obj = {\n          _id: movement._id,\n          isActive: false\n        };\n        this.sliceIcome(movement);\n        this.$store.dispatch('incomes/putIncome', obj).then(res => {\n          if (res) {\n            this.showIncomes = true;\n            this.$toasted.show('Documento eliminado!');\n            this.$router.push('/outcomes');\n          }\n        });\n      }\n    }\n  },\n  computed: {\n    ...mapGetters({\n      getUser: 'users/user',\n      getErrors: 'incomes/getErrors',\n      getOutcomes: 'incomes/getIncomes',\n      getBusinessScope: 'getBusinessScope',\n      getCurrencyConfig: 'getCurrencyConfig'\n    }),\n    ...mapState({\n      outcomesGetParams: 'incomesGetParams'\n    })\n  },\n\n  mounted() {\n    this.isMobile = isMobile;\n    return new Promise((resolve, reject) => {\n      if (this.getBusinessScope._id) {\n        resolve('/' + this.getBusinessScope._id);\n      } else {\n        resolve('');\n      }\n    }).then(data => {\n      this.loading = true;\n      this.getAllOutcomes({\n        params: `${this.outcomesGetParams}`,\n        type: 'out',\n        isBusiness: data\n      })\n        .then(res => {\n          this.outcomes = res;\n          this.loading = false;\n        })\n        .catch(err => {\n          console.log('this.getErrors --> ', this.getErrors);\n        });\n    });\n  },\n\n  watch: {\n    outcomesGetParams: function() {\n      this.getAllOutcomes(`${this.outcomesGetParams}`);\n    },\n    getBusinessScope: function(val) {\n      this.getAllOutcomes({\n        params: `${this.outcomesGetParams}`,\n        type: 'out',\n        isBusiness: val._id ? '/' + this.getBusinessScope._id : ''\n      });\n    }\n  },\n  beforeRouteEnter: (to, from, next) => {\n    store.commit('HANDLE_ISOUTCOME', true);\n    next();\n  },\n\n  beforeRouteLeave(to, from, next) {\n    store.commit('HANDLE_ISOUTCOME', false);\n    next();\n  }\n};\n",{"version":3,"sources":["outcomes.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqJA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"outcomes.vue","sourceRoot":"src/pages/outcomes","sourcesContent":["<template>\n  <div>\n    <div>\n      <div v-if=\"getErrors\">\n        <error-modal :errorObject=\"getErrors\"></error-modal>\n      </div>\n\n      <!-- LISTA -->\n      <div class=\"md-layout\">\n        <div class=\"md-layout-item md-size-10F0 md-xsmall-size-100\">\n          <div v-if=\"loading\">\n            <spinner></spinner>\n          </div>\n\n          <center v-if=\"!outcomes.docs\"></center>\n\n          <ul v-else class=\"collection\" style=\"padding: 0; border-style: none;\">\n            <div class=\"container-fluid\" v-if=\"getOutcomes.docs.length <= 0\">\n              <center class=\"spinner\">\n                <md-empty-state\n                  md-icon=\"add_shopping_cart\"\n                  md-label=\"No tienes compras\"\n                  md-description=\"Haz tu primera compra mediante unabase\"\n                ></md-empty-state>\n              </center>\n              <center>\n                <router-link\n                  :to=\"{path:'/outcome'}\"\n                  class=\"md-success md-raised md-simple\"\n                  tag=\"md-button\"\n                >Nueva compra</router-link>\n              </center>\n            </div>\n            <div v-else>\n              <transition-group name=\"slide-fade\">\n                <li\n                  class=\"collection-item avatar\"\n                  v-for=\"(outcome, index) in getOutcomes.docs\"\n                  :key=\"outcome._id\"\n                  @click=\"handleBottomNav(false)\"\n                  v-hammer:swipe.right=\"(event)=> deleteIncome(outcome, index)\"\n                >\n                  <div>\n                    <router-link :to=\"{path:'/outcome/'+outcome._id}\" style=\"color: black;\">\n                      <div v-if=\"outcome.responsable.type == 'User'\" style=\"margin-bottom: -83px;\">\n                        <div class=\"row\">\n                          <div class=\"col s12\">\n                            <img\n                              v-if=\"outcome.responsable.data.imgUrl\"\n                              :src=\"outcome.responsable.data.imgUrl\"\n                              alt\n                              :class=\"[(outcome.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                              style=\"vertical-align: center;\"\n                            >\n                            <img\n                              v-else\n                              src=\"../../../public/img/default-avatar.png\"\n                              alt\n                              :class=\"[(outcome.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                              style=\"vertical-align: center;\"\n                            >\n                          </div>\n                        </div>\n                        <br>\n                        <div class=\"row\">\n                          <div class=\"col s12\" style=\"margin-left: -60px;\">\n                            <small\n                              :class=\"[(outcome.state == 'draft')?'text-warning': 'text-success']\"\n                            >{{(outcome.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div v-else style=\"margin-bottom: -83px;\">\n                        <div style=\"display:contents\" v-if=\"outcome.responsable.type == 'Business'\">\n                          <div class=\"row\">\n                            <div class=\"col s12\">\n                              <img\n                                src=\"../../assets/img/company_icon.png\"\n                                alt\n                                :class=\"[(outcome.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                                style=\"vertical-align: center;\"\n                              >\n                            </div>\n                          </div>\n                          <br>\n                          <div class=\"row\">\n                            <div class=\"col s12\" style=\"margin-left: -60px;\">\n                              <small\n                                :class=\"[(outcome.state == 'draft')?'text-warning': 'text-success']\"\n                              >{{(outcome.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                            </div>\n                          </div>\n                        </div>\n                        <div style=\"display:contents\" v-else>\n                          <div class=\"row\">\n                            <div class=\"col s12\">\n                              <img\n                                src=\"../../../public/img/default-avatar.png\"\n                                alt\n                                :class=\"[(outcome.state == 'draft')?'pendingClass': 'successClass', 'circle']\"\n                                style=\"vertical-align: center;\"\n                              >\n                            </div>\n                          </div>\n                          <br>\n                          <div class=\"row\">\n                            <div class=\"col s12\" style=\"margin-left: -60px;\">\n                              <small\n                                :class=\"[(outcome.state == 'draft')?'text-warning': 'text-success']\"\n                              >{{(outcome.state == 'draft')?'Pendiente':'Finalizada'}}</small>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <span class>\n                        <b>{{outcome.name}}</b>\n                      </span>\n\n                      <p>\n                        {{get_clientName(outcome.responsable)}}\n                        <br>\n                        <small>{{outcome.createdAt | shortDate}}</small>\n                      </p>\n\n                      <a style=\"text-decoration: none;\" class=\"secondary-content valign-wrapper\">\n                        <h5\n                          v-if=\"isMobile\"\n                          class=\"text-center text-success\"\n                        >{{(getTotal(outcome.lines).total) | currency}}</h5>\n                        <h3\n                          v-else\n                          class=\"text-center text-success\"\n                        >{{(getTotal(outcome.lines).total) | currency}}</h3>\n                      </a>\n                    </router-link>\n                  </div>\n                </li>\n              </transition-group>\n            </div>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// VUEX\nimport { mapActions, mapGetters, mapMutations, mapState } from 'vuex';\nimport { Modal } from '@/components';\nimport store from '../../store/store.js';\nimport isMobile from '../../assets/js/isMobile.js';\n\nimport errorModal from '@/pages/Dashboard/Components/errorModal.vue';\nimport spinner from '../Dashboard/Components/spinner';\nimport _ from 'lodash';\n\nimport {\n  ChartCard,\n  ProductCard,\n  AnimatedNumber,\n  GlobalSalesCard\n} from '@/components';\n\nexport default {\n  components: {\n    Modal,\n    errorModal,\n    ChartCard,\n    spinner\n  },\n\n  data() {\n    return {\n      checkbox1: null,\n      outcomes: [],\n      value: null,\n      loading: false,\n      isMobile: null\n    };\n  },\n\n  methods: {\n    ...mapActions({\n      getAllOutcomes: 'incomes/getAllIncomes'\n    }),\n    ...mapMutations({\n      hideShowBottom: 'HIDE_SHOW_BOTTOM',\n      cleanItem: 'items/CLEAN',\n      sliceIcome: 'incomes/SLICE_INCOME'\n    }),\n\n    handleBottomNav(state) {\n      this.cleanItem();\n    },\n    get_clientName(responsable) {\n      if (\n        responsable.type == 'User' ||\n        responsable.type == 'Contact' ||\n        responsable.type == 'Business'\n      ) {\n        return responsable.data.name;\n      } else {\n        return responsable.name;\n      }\n    },\n    getTotal(lines) {\n      let total = _.sumBy(lines, function(line) {\n        return line.price * line.quantity;\n      });\n\n      return {\n        net: total,\n        tax: total * 0.19,\n        total: total * 0.19 + total\n      };\n    },\n    deleteIncome(movement) {\n      this.showIncomes = false;\n      if (movement) {\n        let obj = {\n          _id: movement._id,\n          isActive: false\n        };\n        this.sliceIcome(movement);\n        this.$store.dispatch('incomes/putIncome', obj).then(res => {\n          if (res) {\n            this.showIncomes = true;\n            this.$toasted.show('Documento eliminado!');\n            this.$router.push('/outcomes');\n          }\n        });\n      }\n    }\n  },\n  computed: {\n    ...mapGetters({\n      getUser: 'users/user',\n      getErrors: 'incomes/getErrors',\n      getOutcomes: 'incomes/getIncomes',\n      getBusinessScope: 'getBusinessScope',\n      getCurrencyConfig: 'getCurrencyConfig'\n    }),\n    ...mapState({\n      outcomesGetParams: 'incomesGetParams'\n    })\n  },\n\n  mounted() {\n    this.isMobile = isMobile;\n    return new Promise((resolve, reject) => {\n      if (this.getBusinessScope._id) {\n        resolve('/' + this.getBusinessScope._id);\n      } else {\n        resolve('');\n      }\n    }).then(data => {\n      this.loading = true;\n      this.getAllOutcomes({\n        params: `${this.outcomesGetParams}`,\n        type: 'out',\n        isBusiness: data\n      })\n        .then(res => {\n          this.outcomes = res;\n          this.loading = false;\n        })\n        .catch(err => {\n          console.log('this.getErrors --> ', this.getErrors);\n        });\n    });\n  },\n\n  watch: {\n    outcomesGetParams: function() {\n      this.getAllOutcomes(`${this.outcomesGetParams}`);\n    },\n    getBusinessScope: function(val) {\n      this.getAllOutcomes({\n        params: `${this.outcomesGetParams}`,\n        type: 'out',\n        isBusiness: val._id ? '/' + this.getBusinessScope._id : ''\n      });\n    }\n  },\n  beforeRouteEnter: (to, from, next) => {\n    store.commit('HANDLE_ISOUTCOME', true);\n    next();\n  },\n\n  beforeRouteLeave(to, from, next) {\n    store.commit('HANDLE_ISOUTCOME', false);\n    next();\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n#tabla_ventas {\n  display: none;\n}\n\n@media (min-width: 992px) {\n  .md-hide-big {\n    display: none;\n  }\n}\n\n.md-layout-item {\n  padding-right: 0px;\n  padding-left: 0px;\n}\n\n.md-tabs {\n  margin-bottom: 24px;\n}\n.spinner {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  // position: fixed;\n  align-items: center;\n  justify-content: center;\n}\n\n.pendingClass {\n  border-color: #ffd600;\n  border-style: ridge;\n}\n.successClass {\n  border-color: #00c853;\n  border-style: ridge;\n}\n</style>\n"]}]}